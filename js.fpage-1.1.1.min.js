/**
 * 分页组件 fpage(js)
 *
 * @author Jun Wu
 * @version 1.1.1 2012-06-05
 * @param String dom 页面DOM ID
 * @param Integer current 当前页
 * @param Integer total 结果总数
 * @param Integer per 每页显示数
 * @param String type 链接类型。js为javascript，link为普通超链接
 * @param String ext 链接字串。如'?type=abc&p='则输出“?type=abc&p=页码”的链接
 * @param String mode 输出格式(可重复)。<表示“上一页”，>表示下一页，*表示页码区，=表示跳转区。
 */

function fpage(a) {
  function b(a) {
    switch (a) {
      case "<":
        page_area += this.to_prev;
        break;
      case ">":
        page_area += this.to_next;
        break;
      case "*":
        page_area += this.pages;
        break;
      case "=":
        page_area += this.form;
    }
  }
  this.dom = a.dom;
  this.current = parseInt(a.current);
  this.total = parseInt(a.total);
  this.per = parseInt(a.per);
  this.total_page = Math.ceil(this.total / this.per);
  this.type = a.type;
  this.ext = a.ext;
  this.mode = a.mode;
  this.l = this.ext.split("###");
  1 > this.current && (this.current = 1);
  this.current > this.total_page && (this.current = this.total_page);
  if (0 < this.total) {
    this.to_prev = ' <button class="btn wd2"';
    1 == this.current && (this.to_prev += ' disabled="disabled"');
    this.to_prev += ' onClick="';
    this.to_prev += this.l[0];
    this.to_prev += this.current - 1;
    "undefined" != typeof this.l[1] && (this.to_prev += this.l[1]);
    this.to_prev += '">';
    this.to_prev += "\u4e0a\u4e00\u9875";
    this.to_prev += "</button> ";
    this.to_next = ' <button class="btn wd2"';
    this.current == this.total_page && (this.to_next += ' disabled="disabled"');
    this.to_next += ' onClick="';
    this.to_next += this.l[0];
    this.to_next += this.current + 1;
    "undefined" != typeof this.l[1] && (this.to_next += this.l[1]);
    this.to_next += '">';
    this.to_next += "\u4e0b\u4e00\u9875";
    this.to_next += "</button> ";
    this.pages = "";
    if (10 >= this.total_page)
      for (a = 1; a <= this.total_page; a++) {
        if (
          (a != this.current &&
            ((this.pages += ' <a href="'),
            (this.pages += this.l[0]),
            (this.pages += a),
            "undefined" != typeof this.l[1] && (this.pages += this.l[1]),
            (this.pages += '">')),
          a == this.current && (this.pages += "<strong>"),
          (this.pages += a),
          a == this.current && (this.pages += "</strong>"),
          a != this.current)
        )
          this.pages += "</a> ";
      }
    else if (10 > this.current) {
      for (a = 1; 10 >= a; a++)
        if (
          (a != this.current &&
            ((this.pages += ' <a href="'),
            (this.pages += this.l[0]),
            (this.pages += a),
            "undefined" != typeof this.l[1] && (this.pages += this.l[1]),
            (this.pages += '">')),
          a == this.current && (this.pages += "<strong>"),
          (this.pages += a),
          a == this.current && (this.pages += "</strong>"),
          a != this.current)
        )
          this.pages += "</a> ";
      this.pages += " ... ";
      this.pages += ' <a href="';
      this.pages += this.l[0];
      this.pages += this.total_page;
      "undefined" != typeof this.l[1] && (this.pages += this.l[1]);
      this.pages += '">';
      this.pages += this.total_page;
      this.pages += "</a> ";
    } else if (10 > this.total_page - this.current) {
      this.pages += ' <a href="';
      this.pages += this.l[0];
      this.pages += "1";
      "undefined" != typeof this.l[1] && (this.pages += this.l[1]);
      this.pages += '">';
      this.pages += "1";
      this.pages += "</a> ";
      this.pages += " ... ";
      for (a = this.total_page - 10; a <= this.total_page; a++)
        if (
          (a != this.current &&
            ((this.pages += ' <a href="'),
            (this.pages += this.l[0]),
            (this.pages += a),
            "undefined" != typeof this.l[1] && (this.pages += this.l[1]),
            (this.pages += '">')),
          a == this.current && (this.pages += "<strong>"),
          (this.pages += a),
          a == this.current && (this.pages += "</strong>"),
          a != this.current)
        )
          this.pages += "</a> ";
    } else {
      this.pages += ' <a href="';
      this.pages += this.l[0];
      this.pages += "1";
      "undefined" != typeof this.l[1] && (this.pages += this.l[1]);
      this.pages += '">';
      this.pages += "1";
      this.pages += "</a> ";
      this.pages += ' <a href="';
      this.pages += this.l[0];
      this.pages += "2";
      "undefined" != typeof this.l[1] && (this.pages += this.l[1]);
      this.pages += '">';
      this.pages += "2";
      this.pages += "</a> ";
      this.pages += " ... ";
      for (a = this.current - 5; a <= this.current + 5; a++)
        if (
          (a != this.current &&
            ((this.pages += ' <a href="'),
            (this.pages += this.l[0]),
            (this.pages += a),
            "undefined" != typeof this.l[1] && (this.pages += this.l[1]),
            (this.pages += '">')),
          a == this.current && (this.pages += "<strong>"),
          (this.pages += a),
          a == this.current && (this.pages += "</strong>"),
          a != this.current)
        )
          this.pages += "</a> ";
      this.pages += " ... ";
      this.pages += ' <a href="';
      this.pages += this.l[0];
      this.pages += this.total_page - 1;
      "undefined" != typeof this.l[1] && (this.pages += this.l[1]);
      this.pages += '">';
      this.pages += this.total_page - 1;
      this.pages += "</a> ";
      this.pages += ' <a href="';
      this.pages += this.l[0];
      this.pages += this.total_page;
      "undefined" != typeof this.l[1] && (this.pages += this.l[1]);
      this.pages += '">';
      this.pages += this.total_page;
      this.pages += "</a> ";
    }
    this.form = " <span>\u5230\u7b2c ";
    this.form += ' <input type="text" value="';
    this.form += this.current;
    this.form += '" /> \u9875 ';
    this.form += ' <button class="btn wd2" onClick="';
    "link" == this.type && (this.form += "window.location='");
    this.form += this.l[0];
    this.form += "this.parentNode.getElementsByTagName('input')[0].value";
    "undefined" != typeof this.l[1] && (this.form += this.l[1]);
    "link" == this.type && (this.form += "'");
    this.form += '">';
    this.form += "\u786e\u5b9a";
    this.form += "</button></span> ";
  }
  this.str = this.mode.split("");
  this.page_area = "";
  for (j in this.str) b(this.str[j]);
  for (k in this.dom)
    document.getElementById(this.dom[k]).innerHTML = this.page_area;
}
